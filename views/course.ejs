<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Bootstrap Table with Add and Delete Row Feature</title>
    <link rel="stylesheet" href="/css/course.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round|Open+Sans"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <style>
      .addcourse .edit {
        text-align: center;

        width: 200px;

        align-items: center;

        position: relative;
      }
      .addcourse .row {
        align-content: center;
      }
      .addcourse .button {
        background-color: #03a9f4;
      }
    </style>

    <!-- <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script> -->
    <!-- <script>
      $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();
        var actions = $("table td:last-child").html();
        // Append table with add row form on add new button click
        $(".add-new").click(function () {
          $(this).attr("disabled", "disabled");
          var index = $("table tbody tr:last-child").index();
          var row =
            "<tr>" +
            '<td><input type="text" class="form-control" name="name" id="name"></td>' +
            '<td><input type="text" class="form-control" name="department" id="department"></td>' +
            '<td><input type="text" class="form-control" name="phone" id="phone"></td>' +
            "<td>" +
            actions +
            "</td>" +
            "</tr>";
          $("table").append(row);
          $("table tbody tr")
            .eq(index + 1)
            .find(".add, .edit")
            .toggle();
          $('[data-toggle="tooltip"]').tooltip();
        });
        // Add row on add button click
        $(document).on("click", ".add", function () {
          var empty = false;
          var input = $(this).parents("tr").find('input[type="text"]');
          input.each(function () {
            if (!$(this).val()) {
              $(this).addClass("error");
              empty = true;
            } else {
              $(this).removeClass("error");
            }
          });
          $(this).parents("tr").find(".error").first().focus();
          if (!empty) {
            input.each(function () {
              $(this).parent("td").html($(this).val());
            });
            $(this).parents("tr").find(".add, .edit").toggle();
            $(".add-new").removeAttr("disabled");
          }
        });
        // Edit row on edit button click

        $(document).on("click", ".edit", function () {
          $(this)
            .parents("tr")
            .find("td:not(:last-child)")
            .each(function () {
              $(this).html(
                '<input type="text" class="form-control" value="' +
                  $(this).text() +
                  '">'
              );
            });
          $(this).parents("tr").find(".add, .edit").toggle();
          $(".add-new").attr("disabled", "disabled");
        });
        // Delete row on delete button click
        $(document).on("click", ".delete", function () {
          $(this).parents("tr").remove();
          $(".add-new").removeAttr("disabled");
        });
      });
    </script> -->
  </head>
  <body>
    <div class="container">
      <div class="table-wrapper">
        <div class="table-title">
          <div class="row">
            <div class="col-sm-8">
              <h2>Employee <b>Details</b></h2>
            </div>
            <div class="col-sm-4">
              <button type="button" class="btn btn-info add-new">
                <i class="fa fa-plus"></i> Add New
              </button>
            </div>
          </div>
        </div>

        <table class="table table-bordered">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Department</th>
              <th>Actions</th>
              <!-- <th>Phone</th>
              <th>Actions</th> -->
            </tr>
          </thead>
          <tbody id="dis">
            <!-- <table class="tables">
              <div id="dis"></div>
            </table> -->
            <script>
              function load() {
                $.ajax({
                  url: "http://localhost:3000/api/select/course",
                }).done(function (renobj) {
                  var res = "";
                  console.log(renobj);
                  if (renobj.status === "Valid") {
                    $.each(renobj.data, function (i) {
                      console.log(renobj.data[i]);
                      res = res + "<tr>";
                      res = res + "<td>" + renobj.data[i].course_id + "</td>";
                      res = res + "<td>" + renobj.data[i].course_name + "</td>";
                      res = res + "<td>" + renobj.data[i].department + "</td>";

                      res = res + "<td>";
                      res =
                        res +
                        '<a class="add" title="Add" data-toggle="tooltip"> <i class="material-icons">&#xE03B;</i>';
                      res =
                        res +
                        ' </a><a class="edit" title="Edit" data-toggle="tooltip"><i class="material-icons">&#xE254;</i> </a>';
                      res =
                        res +
                        ' <a href="/api/delete/course/' +
                        renobj.data[i].course_id +
                        '"class="delete" title="Delete" data-toggle="tooltip" id="dlt" ><i class="material-icons">&#xE872;</i></a>';

                      res =
                        res +
                        "<td><button  onclick='dele(" +
                        renobj.data[i].course_id +
                        ")' ><i class='material-icons'>&#xE872;</i></button></td>";
                      res = res + "</td>";
                      res = res + "</tr>";
                    });
                    res = res + "";
                    $("#dis").html(res);
                  } else {
                    alert("Error");
                  }
                });
              }

              function dele(id) {
                $.ajax({
                  url: "http://localhost:3000/api/delete/course/" + id,
                });
                load();
              }
            </script>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row addcourse">
      <center>
        <div class="edit form-group">
          <form id="frm" method="POST">
            Course Name
            <input
              type="text"
              class="form-control"
              name="course_name"
              id="course_name"
              value=""
            />
            <br />
            Department
            <input
              type="text"
              class="form-control"
              name="department"
              id="department"
              value=""
            />
            <br />
            <input
              class="btn btn-primary"
              type="submit"
              style="background-color: #03a9f4"
              value="Save"
            />
          </form>
        </div>
      </center>
    </div>
    <script>
      $(document).ready(function () {
        load();
        // loadSelect();
        $("#frm").submit(function (e) {
          console.log($("#frm").serialize());
          e.preventDefault();
          $.ajax({
            url: "http://localhost:3000/api/insert/course",
            type: "post",
            data: $("#frm").serialize(),
          }).done(function (renobj) {
            if (renobj.status === "Valid") {
              alert("Saved");

              $("#course_name").val("");
              $("#department").val("");
              load();
            }
          });
        });
      });
    </script>
  </body>
</html>
